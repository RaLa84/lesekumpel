<!DOCTYPE html>
<html lang="de" data-syllmode="off">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Deine Geschichte</title>
  <link href="https://fonts.googleapis.com/css2?family=Atkinson+Hyperlegible:wght@400;700&family=Comic+Sans+MS&display=swap" rel="stylesheet">
  
  <style>
    :root {
      --bg:#f0f8ff; --fg:#16202a; --brand:#ff6b6b; --border:#ffcc00; --focus:#ffd54a; --card:#ffffff;
    }

    body {
      margin:0; padding:0; /* Wichtig: Kein Padding mehr am Body f√ºr Full-Width Header */
      background:var(--bg); color:var(--fg);
      font-family: 'Atkinson Hyperlegible', 'Comic Sans MS', sans-serif;
      display: flex; flex-direction: column; align-items: center;
    }

    /* --- HEADER & NAVIGATION --- */
    header {
      position: sticky; top: 0; width: 100%; background: var(--card);
      border-bottom: 3px solid var(--border); z-index: 1000;
      box-shadow: 0 4px 10px rgba(0,0,0,0.05);
    }

    .nav-wrap {
      max-width: 900px; margin: 0 auto; padding: 10px 20px;
      display: flex; align-items: center; justify-content: space-between;
    }

    /* Logo & Name */
    .brand {
      display: flex; align-items: center; gap: 10px;
      text-decoration: none; color: var(--brand); font-weight: 700; font-size: 1.5em;
      font-family: 'Comic Sans MS', sans-serif;
    }
    .brand img { height: 45px; width: auto; border-radius: 8px; }

    /* Desktop Men√º */
    .nav-links { display: flex; gap: 15px; align-items: center; }
    .nav-btn {
      text-decoration: none; color: #555; font-weight: bold;
      padding: 8px 15px; border-radius: 20px; transition: all 0.2s;
      border: 2px solid transparent;
    }
    .nav-btn:hover { background: #fff5e6; color: var(--brand); }
    .nav-btn.cta { border-color: var(--border); background: #fff; }
    .nav-btn.cta:hover { background: var(--brand); color: #fff; border-color: var(--brand); }

    /* Burger Button (Standard unsichtbar) */
    .burger {
      display: none; background: none; border: 2px solid var(--border);
      border-radius: 8px; cursor: pointer; padding: 5px; color: var(--brand);
    }
    .burger svg { width: 28px; height: 28px; display: block; }

    /* Mobile Men√º (Standard versteckt) */
    .mobile-menu {
      display: none; position: absolute; top: 100%; left: 0; width: 100%;
      background: var(--card); border-bottom: 3px solid var(--border);
      flex-direction: column; padding: 10px 0;
      box-shadow: 0 10px 20px rgba(0,0,0,0.1);
    }
    .mobile-menu a {
      display: block; padding: 15px 20px; text-decoration: none;
      color: #555; font-weight: bold; border-bottom: 1px solid #eee;
    }
    .mobile-menu a:hover { background: #fff9e6; color: var(--brand); }

    /* Media Query f√ºr Handys */
    @media (max-width: 700px) {
      .nav-links { display: none; } /* Desktop Links weg */
      .burger { display: block; }   /* Burger da */
      .mobile-menu.open { display: flex; } /* Men√º zeigen wenn offen */
    }


    /* --- HAUPT CONTAINER --- */
    .container {
      max-width: 800px; width: 90%; 
      background:var(--card); padding: 40px;
      border-radius: 20px; border: 5px solid var(--border);
      box-shadow: 0 10px 25px rgba(0,0,0,0.05);
      position: relative;
      margin-top: 30px; margin-bottom: 40px; /* Abstand zum Header/Footer */
    }

    /* TOOLBAR */
    .tools {
      display:flex; flex-wrap:wrap; gap:10px; justify-content:center;
      background: #fff9e6; padding: 15px; border-radius: 15px;
      margin-bottom: 30px; border: 2px dashed var(--border);
    }
    button {
      background: white; border: 2px solid var(--border); border-radius: 10px;
      padding: 10px 15px; cursor: pointer; font-weight: 700; color: #555;
      font-family: inherit; transition: all 0.1s;
    }
    button:hover { transform: translateY(-2px); border-color: var(--brand); color: var(--brand); }
    button[aria-pressed="true"] { background: var(--brand); color: white; border-color: var(--brand); }

    /* INHALT */
    h1 { color: var(--brand); text-align: center; font-size: 2.5em; text-transform: uppercase; margin-bottom: 20px; }
    
    #story-content { font-size: 1.4em; line-height: 1.8; color: #444; transition: font-size 0.2s; }
    
    p { margin-bottom: 1.5rem; }

    /* SILBEN & WORTE */
    .word { position:relative; display: inline-block; margin-right: 0.25em; cursor: default; }
    .syll { padding-bottom:.05em; border-bottom:1px dotted transparent; transition: color 0.2s; }

    /* Modus: Farben */
    [data-syllmode="color"] .word .syll:nth-child(odd){ color: #007bff; }
    [data-syllmode="color"] .word .syll:nth-child(even){ color: #d32f2f; }
    
    /* BILD */
    .story-image {
      display: block; margin: 0 auto 30px auto; width: 100%; max-width: 400px;
      border-radius: 15px; object-fit: contain;
    }

    /* FOOTER */
    .footer { 
        margin-top: 60px; padding-top: 30px; border-top: 3px dashed var(--border); 
        text-align: center; font-size: 1em; color: #888; 
    }
    .footer a { 
        color: #888; text-decoration: none; font-weight: bold; margin: 0 10px; transition: color 0.2s; 
    }
    .footer a:hover { color: var(--brand); }
    .separator { color: var(--border); font-weight: bold; }

    /* LUPE */
    .lens {
      position: fixed; z-index: 9999; pointer-events: none;
      padding: .25rem .75rem; background: white;
      border: 3px solid var(--brand); border-radius: .8rem;
      box-shadow: 0 8px 18px rgba(0,0,0,.15);
      font-weight: 700; font-size: 1.8rem; color: #333;
      transform: translate(-50%, -130%); display: none; white-space: nowrap;
    }
    .lens[data-show="true"] { display: block; }
  </style>
</head>
<body>

  <header>
    <div class="nav-wrap">
      <a href="https://rala84.github.io/lesekumpel/" class="brand">
        <img src="https://rala84.github.io/lesekumpel/logo1.png" alt="Lesekumpel Logo">
        <span>Lesekumpel</span>
      </a>

      <div class="nav-links">
        <a href="../index.html" class="nav-btn">üìö Bibliothek</a>
        <a href="https://rala84.app.n8n.cloud/form/30d75a75-54fd-42fd-bea6-ab24799ca565" class="nav-btn cta">‚ú® Neue Geschichte</a>
      </div>

      <button class="burger" id="burgerBtn" aria-label="Men√º √∂ffnen">
        <svg viewBox="0 0 24 24" stroke="currentColor" stroke-width="2.5" fill="none" stroke-linecap="round" stroke-linejoin="round">
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>
    </div>

    <div class="mobile-menu" id="mobileMenu">
      <a href="../index.html">üìö Zur Bibliothek</a>
      <a href="https://rala84.app.n8n.cloud/form/30d75a75-54fd-42fd-bea6-ab24799ca565">‚ú® Neue Geschichte schreiben</a>
    </div>
  </header>


  <div class="lens" id="lens" data-show="false"><span id="lensText"></span></div>

  <div class="container">
    
    <div class="tools">
      <button id="btnRead">üîä Vorlesen</button>
      <button id="btnFocus" aria-pressed="false">üîç Lupe</button>
      
      <div style="border-left: 2px solid #ddd; padding-left:10px; display:flex; gap:5px;">
        <button id="syllOff" aria-pressed="true">Normal</button>
        <button id="syllColor">üî¥üîµ Farben</button>
      </div>

      <div style="border-left: 2px solid #ddd; padding-left:10px; display:flex; gap:5px;">
        <button id="btnSmaller">A-</button>
        <button id="btnBigger">A+</button>
      </div>
    </div>

    <div id="story-content">
       
<h1>K√§sebrot ‚Äì Der Superheld auf deinem Teller!</h1><img src="../bilder/kaesebrot-der-superheld-auf-deinem-teller.png" onerror="this.onerror=null;this.src='https://rala84.github.io/lesekumpel/bilder/lesekumpel_logo.png';" class="story-image" alt="Bild">

<p>Stell dir vor: Du kommst nach Hause, der Magen knurrt wie ein kleiner B√§r und deine Gedanken kreisen nur noch um eins: ESSEN! Und dann siehst du es: Dein K√§sebrot! Ein echter Klassiker. Aber ist es wirklich nur Brot mit K√§se? <strong>Nein!</strong></p>

<h2>Was macht K√§sebrot so besonders?</h2>

<p>K√§sebrot ist viel mehr! Es ist ein Superhelden-Team aus knusprigem Brot, das manchmal ganz leise <strong>knistert</strong>, wenn du reinbei√üt, und dann dieser K√§se... <strong>Mmmh!</strong> Der ist mal weich und cremig, mal fest und nussig. Manche K√§sesorten zerlaufen ganz langsam und ziehen lange F√§den ‚Äì das ist der absolute Jackpot! Jeder Bissen ein kleines Fest im Mund! <strong>Schmatz!</strong></p>

<h2>Der K√§se-Zauber</h2>

<p>Aber warum schmeckt K√§se eigentlich so unglaublich gut? Das liegt an winzigen Helfern: Bakterien! Keine Sorge, das sind die guten Jungs. Die machen aus normaler Milch diesen Zauberstoff, der dann sp√§ter zu leckeren L√∂chern im Emmentaler oder zu dem kr√§ftigen Geschmack im Gouda wird. Jeder K√§se hat seine eigene Superkraft und seinen ganz besonderen Geschmack. Das ist wie Magie, die man essen kann!</p>

<h2>Deine K√§sebrot-Challenge</h2>

<p>Was ist dein liebstes K√§sebrot? Mit Butter? Ohne? Oder packst du noch Gurken und Tomaten drauf, damit es sch√∂n frisch wird? Egal, wie du es am liebsten magst: K√§sebrot ist immer eine gute Idee. Es ist dein kleiner Energie-Booster f√ºr zwischendurch und schmeckt einfach immer!</p>

    </div>

    <div class="footer">
        <p>Erstellt von deinem KI-Lesekumpel ü§ñ</p>
        <div style="margin-top: 10px;">
            <a href="https://rala84.app.n8n.cloud/form/30d75a75-54fd-42fd-bea6-ab24799ca565">‚ú® Neue Geschichte</a>
            <span class="separator">|</span>
            <a href="../index.html">üìö Zur Bibliothek</a>
        </div>
    </div>

  </div>

  <script>
    // --- BURGER MENU LOGIK ---
    const burgerBtn = document.getElementById('burgerBtn');
    const mobileMenu = document.getElementById('mobileMenu');
    
    burgerBtn.addEventListener('click', () => {
      mobileMenu.classList.toggle('open');
    });

    // --- SILBEN-LOGIK ---
    function getSyllables(word) {
        if (word.length < 3) return [word];
        let w = word;
        w = w.replace(/(sch|ch|ck|ph|th|qu|st|sp)/gi, '¬ß$&¬ß');
        w = w.replace(/([aeiouy√§√∂√º])([^aeiouy√§√∂√º¬ß|])([aeiouy√§√∂√º])/gi, '$1|$2$3');
        w = w.replace(/([aeiouy√§√∂√º])([^aeiouy√§√∂√º¬ß|])([^aeiouy√§√∂√º¬ß|])([aeiouy√§√∂√º])/gi, '$1$2|$3$4');
        w = w.replace(/¬ß/g, '');
        return w.split('|');
    }

    // --- DOM UMBAU ---
    function processNode(node) {
        if (node.nodeType === 3) {
            const text = node.nodeValue;
            if (!text.trim()) return;

            const wrapper = document.createElement('span');
            const parts = text.split(/([ \t\n\r,.!?;:()"]+)/);
            
            parts.forEach(part => {
                if (/[a-zA-Z√§√∂√º√Ñ√ñ√ú√ü]/.test(part)) {
                    const wordSpan = document.createElement('span');
                    wordSpan.className = 'word';
                    const syllables = getSyllables(part);
                    syllables.forEach(syl => {
                        const sSpan = document.createElement('span');
                        sSpan.className = 'syll';
                        sSpan.innerText = syl;
                        wordSpan.appendChild(sSpan);
                    });
                    wrapper.appendChild(wordSpan);
                } else {
                    wrapper.appendChild(document.createTextNode(part));
                }
            });
            node.parentNode.replaceChild(wrapper, node);
        } else if (node.nodeType === 1) {
            // Tools, Scripts etc. ignorieren
            if (['SCRIPT','STYLE','BUTTON','IMG','HEADER'].includes(node.tagName)) return;
            if (node.classList.contains('tools') || node.classList.contains('footer')) return;
            Array.from(node.childNodes).forEach(processNode);
        }
    }

    // --- HAUPT PROGRAMM ---
    document.addEventListener("DOMContentLoaded", () => {
      const contentRoot = document.getElementById('story-content');
      processNode(contentRoot);
      console.log("Lesekumpel: Text wurde verarbeitet.");

      const root = document.documentElement;
      
      // Buttons Logik
      document.getElementById('syllOff').onclick = () => setSyllMode('off');
      document.getElementById('syllColor').onclick = () => setSyllMode('color');

      function setSyllMode(mode) {
         root.setAttribute('data-syllmode', mode);
         document.getElementById('syllOff').setAttribute('aria-pressed', mode === 'off');
         document.getElementById('syllColor').setAttribute('aria-pressed', mode === 'color');
      }

      // Schriftgr√∂√üe
      let currentSize = 1.4;
      document.getElementById('btnBigger').onclick = () => {
         if (currentSize < 3.0) { currentSize += 0.2; contentRoot.style.fontSize = currentSize + "em"; }
      };
      document.getElementById('btnSmaller').onclick = () => {
         if (currentSize > 0.8) { currentSize -= 0.2; contentRoot.style.fontSize = currentSize + "em"; }
      };

      // Lupe
      const btnFocus = document.getElementById('btnFocus');
      const lens = document.getElementById('lens');
      const lensText = document.getElementById('lensText');
      let lensActive = false;

      btnFocus.onclick = () => {
          lensActive = !lensActive;
          btnFocus.setAttribute('aria-pressed', lensActive);
          if(!lensActive) lens.dataset.show = "false";
      };

      document.addEventListener('mousemove', (e) => {
          if (!lensActive) return;
          const target = e.target.closest('.word');
          if (target) {
              lens.dataset.show = "true";
              lensText.innerText = target.innerText;
              lens.style.left = e.clientX + 'px';
              lens.style.top = e.clientY + 'px';
          } else {
              lens.dataset.show = "false";
          }
      });

      // Vorlesen
      const btnRead = document.getElementById('btnRead');
      let isSpeaking = false;

      btnRead.onclick = () => {
          if(isSpeaking) {
              window.speechSynthesis.cancel();
              isSpeaking = false;
              btnRead.innerText = "üîä Vorlesen";
          } else {
              const text = document.getElementById('story-content').innerText;
              const utt = new SpeechSynthesisUtterance(text);
              utt.lang = 'de-DE';
              utt.rate = 0.9;
              utt.onend = () => { isSpeaking = false; btnRead.innerText = "üîä Vorlesen"; };
              window.speechSynthesis.speak(utt);
              isSpeaking = true;
              btnRead.innerText = "‚èπ Stopp";
          }
      };
    });
  </script>
</body>
</html>